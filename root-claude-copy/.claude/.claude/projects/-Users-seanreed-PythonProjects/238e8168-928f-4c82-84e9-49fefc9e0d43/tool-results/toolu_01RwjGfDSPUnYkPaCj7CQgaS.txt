=== COMMIT MESSAGE ===
Nova3 multi lang dev merge branch (#214)

* added noisereduce library

* import noise filter

* upgraded to Nova-3 (multi)

* revert to nova-2 multi

until we figure out how it sets the detected language

* Responses.ADDED_THAT should not be combined with context specific script_addition which overrides its meaning

* try to get quantity to display for combo from itself before resorting to its first item.

* Update agent_prompts_jib.py (#194)

Minor tweak to help enforce small sprite quirks

* combo upsell also needs to isolate applicable order content to modify to avoid duplication (#195)

Co-authored-by: Ben <ben@audivi.ai>

* added missing caution around auto-accept/reject of combo upsell based on accompanying language

* there might not be any upsells

* need to capture children of combos to remove prior to upsell modify to distinguish combos who only differ by children

* remove_matching_combo needed to compare children

* implemented configurable fallback size enforcement

* preserve original case when enforcing fallback size

* attempts to trace snipping root cause

possible race condition

* add buffer time

* updates to better ensure we don't enforce fallback over an intentional modify

* fix for case-preserving replacement of *_larger and *_larger_size properties

* changed state switch to continue-order-validate to resolve issue of add-items that follow not being added to order before upsell check

* upgrading to Nova-3

only one session at a time allowed due to beta.

* testing drivethru model

* Revert "testing drivethru model"

This reverts commit ca134a40b7b76d6ee7105d14ab7479914528de13.

* Revert "upgrading to Nova-3"

This reverts commit 4b3e3148b992b7602007943cc255397407befc74.

* clear resolved upsell at end of transition method

* if entity is exact match for entity in order, don't check for fallback enforcement

* adds default sample rate of 16000

* disabled some logs

* lower the min volume setting

min_volume=0.4

* removed sample_rate

* updates to do full memory

* Revert "updates to do full memory"

This reverts commit 76565c7cd5753be16ad056ac235e43d6632d8c6b.

* updates to ingest full memory

* increased _final_text_buffer_time

self._final_text_buffer_time = 0.8  # Buffer time in seconds before processing final text, initially 0.5

to catch long drawn out words

* global sample_rate 8000

* updated JiB wrong_to_correct

* updated JiB wrong_to_correct

* updated JiB wrong_to_correct

* update wordlist for sides

* updated wordlist for chicken

* updated wordlist for burgers

* updated wordlist for the last 24hrs

* updated Smashed Jack

* updated battery

* updated Ranch

Chicken section

* moved log so it could include response_script

* do not reset the text when UserStoppedSpeakingFrame

* increaseed the stop_secs value to 2.0

frpm 1.6

* move the needle to 3.0

* changes traces to debug

* updates gitignore

* Minor prompt tweak 5 5 piece... (#200)

(cherry picked from commit 650f1a2964c76a5b317173f7531805e3bb23ba2f)

* changes print to log statement in mex_tran

* adds print statement flush=True

* removed cache initiation

* react ti InterimTranscriptionFrame instead

do not accumulate, just update the self._text value

* Revert "react ti InterimTranscriptionFrame instead"

This reverts commit a203cd4f3143a5ec70336889292c688a537c53e4.

* waiting for final transcription

* add additional mermaid diagrams

* using LLMUserContextAggregator

this major overhaul should handle the VAD edge cases while simplifiyng th AudiviProcessor code structure

* doengraded LLMResponseAggregator

to the version available in pipecat 0.0.54, which we currently use

* fix import

* fix Frame imports

* removed offending imports

EmulateUserStartedSpeakingFrame,
    EmulateUserStoppedSpeakingFrame

* remove unused SilenceFrame

* removed SilenceFrame

* import StartFrame

needed by HeadsetInputTransport

to fix this error

audivi_server    |   File "/app/pipeline.py", line 813, in <module>
audivi_server    |     class HeadsetInputTransport(BaseInputTransport):
audivi_server    |   File "/app/pipeline.py", line 829, in HeadsetInputTransport
audivi_server    |     async def start(self, frame: StartFrame):
audivi_server    |                                  ^^^^^^^^^^
audivi_server    | NameError: name 'StartFrame' is not defined. Did you mean: 'TextFrame'?

* add logging

added more detailed logging statements to track the user text at different stages of processing:
[Raw user request]: Shows the initial user text after stripping whitespace
[Processing request in language]: Shows which language the request is being processed in
[State machine response]: Shows the order and response text from the state machine
[Final order] and [Final response text]: Shows the final values before sending to the frontend

* more logging

The log will show:
[LLMContextFrame user text]: The raw user text as it comes from the LLM context frame

* consume LLMMessagesFrame

instead of OpenAILLMContextFrame

* implement context aggregator

* removes State

* reformatted document

* adds opts to Deepgram

* reduces vad_stop_secs to 1.6

* updates liveoptions and sets sample rate to 16000

* moves to nova-3-general for deepgram

* changes lang to en for deepgram

* adds test_audio.py

* adds logger to pipeline.py

* updates pipeline logger

* updates logs again

* updates logs again

* updates logs again

* turns off Deepgram vad events

* update vad_stop_secs = 3

* initial commit

* moved to vad = 2.75

* audio out 24000

* moves vad_stop_secs to param in run_pipeline

* moves vad to 3.0 secs

* removes warning loggers from non-headset code in pipeline

* adds domain to service_name

(cherry picked from commit 620da4b1bd832fd833afe603c948b988aa659576)

* comments out meter provider

* nova-3 goes into GA so remove url

* add red bowl-> red bull

* vad=2.75

* vad=3.0

* sorts replacement strings in pipeline.py

* background chit chit and intra order substitution examples added to classification agent examples for resilience to some edge cases (#210)

(cherry picked from commit 7983378d52c5bcc19dbbff2f32f2bb8547b8f733)

* deleted temp files

---------

Co-authored-by: mermerus <166135455+mermerus@users.noreply.github.com>
Co-authored-by: Ubuntu <ubuntu@ip-172-31-16-192.us-east-2.compute.internal>
Co-authored-by: Ben <ben@audivi.ai>
Co-authored-by: md598 <Mark@duttonracing.com>
Co-authored-by: Ben Thielker <benthielker@gmail.com>
=== FILES CHANGED ===
.gitignore|2|1
bot/audivi_system/.gitignore|0|31
bot/audivi_system/tracing.py|1|0
bot/ingest_agent_memory.py|1|1
bot/mex_tran.py|4|3
bot/pipeline.py|621|526
bot/requirements.txt|1|0
bot/sort|177|0
bot/test_audio.py|13|0
mermaid-diagrams/class_diagram.mermaid|105|0
mermaid-diagrams/entry_points.mermaid|21|0
mermaid-diagrams/pipeline_setup.mermaid|30|0
mermaid-diagrams/processing_sequence.mermaid|31|0
=== COMMIT MESSAGE ===
Uvloop dev merge branch (#220)

* keep punctuation

(cherry picked from commit 248f285ee7072d0e6de93e7a4511bb2b46368f34)

* Revert "keep punctuation"

This reverts commit bcc556d2d2c870d4f84f2166fe0cf7745097028b.

* uvloop all the things

* added flag for whether we can use rule-based fragment check, and ensured its only used for english transcripts when enabled.

(cherry picked from commit a2f086269c7a88b1d73c6eb38de5dd8508add3ae)

* turn_index was not incrementing

(cherry picked from commit 8a9f4252e13f75d0ca3de3e7c0345a8820823116)

* applies ruff to pipeline.py and runner.py

* harmonizes bot/requirements.txt and bot/audivi_system/requirements.txt

---------

Co-authored-by: mermerus <166135455+mermerus@users.noreply.github.com>
Co-authored-by: Ben <ben@audivi.ai>
=== FILES CHANGED ===
bot/agent_task_review_tool.py|2|1
bot/audivi_system/agent.py|3|1
bot/audivi_system/ensemble.py|6|5
bot/audivi_system/requirements.txt|9|5
bot/audivi_system/src/agent_utils.py|3|1
bot/audivi_system/src/utils.py|3|1
bot/audivi_system/state_machine.py|3|2
bot/convo_cli.py|3|2
bot/otel/config-samples/docker-config.yaml|10|0
bot/pipeline.py|4|7
bot/requirements.txt|1|0
bot/runner.py|183|114
bot/sort|0|177
bot/test_audio.py|3|1
=== COMMIT MESSAGE ===
Bump sentence transformers (#223)

* let sentence transformers float, pin explicit accerate and transformers

* let sentence transformers float, pin explicit accerate and transformers

* copies bot/requirements.txt to bot/audivi_system/requirements.txt
=== FILES CHANGED ===
bot/audivi_system/requirements.txt|3|1
bot/requirements.txt|3|1
=== COMMIT MESSAGE ===
Add otel to agent (#228)

* begins annotation of agent.py with attributes and events

* ends get_order_upsell_intent, starts get_customer_question_intent

* continues agent span updates

* completes v1 of agent.py and otel annotations
=== FILES CHANGED ===
bot/audivi_system/agent.py|157|29
=== COMMIT MESSAGE ===
Add ds data to otel (#235)

* sets attributes for ds data

* adds compression to otel collector

* adds back batch to log processors

* updates autocorrect to include charles->churros

* v1 completed
=== FILES CHANGED ===
bot/audivi_system/ensemble.py|29|3
bot/otel/collector-config.yaml|2|0
bot/pipeline.py|1|0
=== COMMIT MESSAGE ===
rewrite json to tables (#239)


=== FILES CHANGED ===
bot/audivi_system/ensemble.py|1|10
=== COMMIT MESSAGE ===
Send otel to s3 (#241)

* updates s3 for traces

* sends otel to s3. need to process by trace next

* increases batch sizes so that s3 has bigger file sizes instead of lots of small files

* increases timeout
=== FILES CHANGED ===
bot/otel/collector-config.yaml|33|6
=== COMMIT MESSAGE ===
uvloop all the things (#252)


=== FILES CHANGED ===
bot/audivi_system/client_relay.py|2|0
bot/audivi_system/convo_relay.py|2|0
bot/convo_cli.py|2|1
=== COMMIT MESSAGE ===
Otel update - to merge all threads and processes into a common span for honeycomb (#262)

* adds otel instrumentation

* adds threading instrumentor

* adds fastapi instrumentor to runner.py

* update

* removes instrumented decorator from client_relay.py

* removes tracer shutdown

* state_machine_transition is not sharing context

* final commit

* adds gunicorn to imports for otel

* more instrumentation

* instruments some more

* still going

* adds explicit coros to asyncioinstrumentor for easier tracking

* returns deleted session id

* update

* down to 4 root spans (3 to go)

* removes unneeded installs from requirements.txt
=== FILES CHANGED ===
bot/audivi_system/agent.py|13|1
bot/audivi_system/client_relay.py|29|2
bot/audivi_system/convo_relay.py|42|9
bot/audivi_system/ensemble.py|5|5
bot/audivi_system/src/state_utils.py|1|0
bot/audivi_system/state_machine.py|34|2
bot/audivi_system/tracing.py|16|3
bot/otel/collector-config.yaml|1|4
bot/otel/samples/otel3.py|29|0
bot/otel/samples/otel4.py|29|0
bot/otel/samples/otel_get_coros_to_trace.py|11|0
bot/otel/samples/otel_pass_context.py|56|0
bot/pipeline.py|7|5
bot/requirements.txt|2|0
bot/runner.py|17|3
pyproject.toml|4|0
uv.lock|204|0
=== COMMIT MESSAGE ===
Otel 0501 (#263)

* adds more explicit methods to list in tracing.py

* adds more explicity function names to tracing.py
=== FILES CHANGED ===
bot/audivi_system/client_relay.py|8|8
bot/audivi_system/convo_relay.py|10|8
bot/audivi_system/state_machine.py|3|1
bot/audivi_system/tracing.py|2|2
bot/pipeline.py|12|8
=== COMMIT MESSAGE ===
updates typo in readme

=== FILES CHANGED ===
README.md|1|1
=== COMMIT MESSAGE ===
updates all files (#293)


=== FILES CHANGED ===
.gitattributes|8|0
bot/audivi_system/agent.py|1|1
bot/audivi_system/agent_prompts_wat.py|3|3
bot/audivi_system/ensemble.py|3|1
bot/audivi_system/json/WAT_menu_v001_v2.json|2359|0
bot/audivi_system/state_machine.py|1|1
bot/database.py|43|2
bot/database_manager/db_factory_reset.sh|1|1
=== COMMIT MESSAGE ===
Elasticache (#302)

* set public elasticache host in env

* adds new timescaledb script from David and new env vars into README.md

* corrects bug introduced in database_writes_on refactor

* remove redis container from docker compose

* fix Fries -> fries

response_text.lower() so that the TTS can pronounce Fries correctly

(cherry picked from commit 81971301e7b1336547a026e628c08068f1a0071e)

* removes redis from otel profile in docker compose

* adds elasticache reference to pos_agnostic

* reverts docker compose

---------

Co-authored-by: mermerus <166135455+mermerus@users.noreply.github.com>
=== FILES CHANGED ===
README.md|11|4
bot/audivi_system/client_relay.py|3|3
bot/audivi_system/convo_relay.py|4|5
bot/audivi_system/src/state_utils.py|3|3
bot/pipeline.py|1|1
bot/telemetrix.py|1|1
docker-compose.yml|1|1
posrelay/pos_relay.py|3|3
posrelay/src/orders.py|6|1
posrelay/src/pos/pos_agnostic.py|6|1
posrelay/src/utils.py|3|3
=== COMMIT MESSAGE ===
implements USE_ECS env var that defaults to false (#316)


=== FILES CHANGED ===
bot/audivi_system/client_relay.py|6|5
bot/audivi_system/convo_relay.py|6|5
bot/audivi_system/src/state_utils.py|6|5
posrelay/pos_relay.py|6|5
posrelay/src/orders.py|6|5
posrelay/src/pos/pos_agnostic.py|6|5
posrelay/src/utils.py|6|5
=== COMMIT MESSAGE ===
Make all database code and all code that touches it async (#479)

* This is a combination of 15 commits.

* more sed search and replace

* moore

* mooore

* aha

* aha! many fixes

* operator.py fixes

* sql fixes

* more

* less await imports

* async does not like the filter on location_context.py:104

* one

* the saga continues

* more

* sqlalchemy.engine.result.ChunkedIteratorResult object

* sqlalchemy.engine.result.ChunkedIteratorResult object resolved?

* .scalars().first()

* rename firsts

* moore

* moooore

* error is gone

* adds cache

* removes uvloop

* removed damaged cache files

* added async fixes

* updated pipeline.py file

* updates connection string to psycopg3

* Fixed hydrate location

* fixed create_operator_wrapper

* fixed ingest_agent_memory_v2

* fixed insert_parquet_files_from_s3

* Fixed scheduler and jobs

* fixed conftest

* refactored InputContext and SessionContext

* Fixed utils

* Fixed convo_cli

* Fixed tests

* Changed user_statement for a test order

* Changed multistep order for more specific request

* Changed multistep order for more specific request: keeping extra pickles

* Added pipecat default tracing (#502)

(cherry picked from commit bdf97dff2715b0633279ae12418a49e243aa8041)

* updates async_engine params

* adds debug to echo logs

* added missing await

* added unimported functions

---------

Co-authored-by: ilya <IlyaKoren@coherentsolutions.com>
Co-authored-by: Ilya Koren <79807943+ilya-koren@users.noreply.github.com>
=== FILES CHANGED ===
bot/agent_task_review_tool.py|8|7
bot/api/analytics.py|630|490
bot/api/auth.py|40|36
bot/api/entities.py|236|237
bot/api/operations.py|223|174
bot/audivi_system/agent.py|13|13
bot/audivi_system/convo_relay.py|11|11
bot/audivi_system/ensemble.py|113|97
bot/audivi_system/order_eval.py|1|1
bot/audivi_system/src/context.py|42|38
bot/audivi_system/src/utils.py|521|353
bot/audivi_system/state_machine.py|11|11
bot/audivi_system/tracing.py|3|0
bot/audivi_system/unit_tests/state_machine/test_state_machine.py|2|2
bot/check_operators.py|9|6
bot/convo_cli.py|138|101
bot/convo_cli_tools.py|84|61
bot/database.py|448|459
bot/database_manager/README.md|6|1
bot/database_manager/address_manager.py|33|27
bot/database_manager/brand_manager.py|24|18
bot/database_manager/delete_operator.py|30|30
bot/database_manager/headset_system_manager.py|48|37
bot/database_manager/hydrate_common_db.py|33|30
bot/database_manager/hydrate_location.py|127|100
bot/database_manager/lane_manager.py|67|53
bot/database_manager/location_context.py|34|41
bot/database_manager/location_headset_manager.py|27|26
bot/database_manager/location_manager.py|109|99
bot/database_manager/location_pos_manager.py|30|25
bot/database_manager/pos_system_manager.py|39|33
bot/database_manager/slug_utils.py|7|3
bot/database_manager/stats_updater.py|38|39
bot/database_manager/system_status.py|38|48
bot/database_manager/table_manager.py|60|60
bot/database_manager/test_system_status.py|1|1
bot/dbase.py|239|16
bot/graveyard/alembic-old/client/env.py|2|2
bot/graveyard/alembic-old/common/env.py|1|1
bot/ingest_agent_memory.py|8|7
bot/ingest_agent_memory_v2.py|58|59
bot/insert_parquet_files_from_s3.py|16|13
bot/inspect_specific_event.py|1|1
bot/language_context_cache_test/cache.db-shm|0|0
bot/language_context_cache_test/cache.db-wal|0|0
bot/manage_clients.py|20|15
bot/migrations/alembic.ini|3|3
bot/migrations/schemas/env.py|13|12
bot/notebooks/location_headset_manager.py|23|22
bot/pipeline.py|33|34
bot/runner.py|3|3
bot/scripts/update_hourly_stats.py|15|13
bot/simulator/simulator_utils.py|15|24
bot/telemetrix.py|298|295
bot/tests/api/test_analytics_performance.py|1|1
bot/tests/api/test_locations.py|38|43
bot/tests/conftest.py|6|6
bot/tests/conversation/enhanced_test_framework.py|1|1
bot/tests/conversation/event_logging_test.py|2|2
bot/tests/conversation/forced_test_event.py|3|3
bot/tests/conversation/multi_conversation_test.py|3|3
bot/tests/conversation/multi_restaurant_test.py|1|1
bot/tests/conversation/print_valid_keys.py|1|1
bot/tests/conversation/simple_docker_test.py|4|4
bot/tests/conversation/simple_framework.py|4|4
bot/tests/conversation/whataburger_latency_test.py|2|2
bot/tests/database/test_database_utils.py|12|12
bot/tests/deepeval/data/examples/WAT-multistep-order-with-modifications.json|1|1
bot/tests/deepeval/data/examples/WAT-one-turn.json|1|1
bot/tests/deepeval/test_conversations.py|1|1
bot/tests/integration/test_hydrate_location.py|49|31
bot/tests/integration/update_test_locations.py|1|1
bot/tests/unit/test_hydrate_location_unit.py|18|13
check_db_values.py|14|11
check_operator_status.py|18|17
scheduler/src/scheduler/jobs.py|21|19
scheduler/src/scheduler/scheduler.py|19|16
=== COMMIT MESSAGE ===
Streamline honeycomb (#509)

* removes some noisy honeycomb instrumentation

* removes more honeycomb logs

* removes more
=== FILES CHANGED ===
bot/audivi_system/agent.py|1|1
bot/audivi_system/ensemble.py|15|15
bot/audivi_system/src/context.py|2|2
bot/audivi_system/src/utils.py|2|2
bot/audivi_system/state_machine.py|5|5
bot/telemetrix.py|2|2
=== COMMIT MESSAGE ===
Diagrams (#494)

* more diagrams

* adds threading report
=== FILES CHANGED ===
diagrams/{startup => }/01-docker-compose-overview.mermaid|0|0
diagrams/{startup => }/02-main-server-startup.mermaid|0|0
diagrams/{startup => }/03-pipeline-startup-flow.mermaid|0|0
diagrams/{startup => }/04-headset-pipeline-creation.mermaid|0|0
diagrams/{startup => }/05-create-pipeline-task-details.mermaid|0|0
diagrams/{startup => }/06-processing-components-startup.mermaid|0|0
diagrams/{startup => }/07-hme-headset-server.mermaid|0|0
diagrams/{startup => }/08-complete-startup-sequence.mermaid|0|0
diagrams/{startup => }/09-data-flow-architecture.mermaid|0|0
diagrams/{startup => }/10-vehicle-arrival-flow.mermaid|0|0
diagrams/{startup => }/11-conversation-start-details.mermaid|0|0
diagrams/{startup => }/12-audio-processing-cycle.mermaid|0|0
diagrams/{startup => }/13-state-machine-transitions.mermaid|0|0
diagrams/{startup => }/14-headset-vehicle-sequence.mermaid|0|0
diagrams/{startup => }/15-relay-system-overview.mermaid|0|0
diagrams/{startup => }/16-convo-relay-details.mermaid|0|0
diagrams/{startup => }/17-client-relay-details.mermaid|0|0
diagrams/{startup => }/18-pos-relay-details.mermaid|0|0
diagrams/{startup => }/19-relay-interaction-sequence.mermaid|0|0
diagrams/{startup => }/20-redis-key-architecture.mermaid|0|0
diagrams/{startup => }/README.md|0|0
diagrams/conversation-service/README.md|97|0
diagrams/conversation-service/current-architecture.mermaid|40|0
diagrams/conversation-service/proposed-architecture.mermaid|46|0
diagrams/threading/01-threading-overview.mermaid|98|0
diagrams/threading/02-convo-relay-threading.mermaid|76|0
diagrams/threading/03-client-relay-threading.mermaid|32|0
diagrams/threading/04-pos-relay-threading.mermaid|75|0
diagrams/threading/05-pos-grpc-server-threading.mermaid|39|0
diagrams/threading/README.md|13|0
diagrams/threading/threading-report.md|265|0
=== COMMIT MESSAGE ===
Init neon (#350)

* initial commit

* adjusts database.DatabaseConfig

* v0.1 complete

* remove pool

* fixes f-string issue and adds required neondb connection strings to README.md
=== FILES CHANGED ===
.neon|3|0
README.md|16|3
bot/alembic.ini|21|1
bot/alembic/common/env.py|6|1
bot/database.py|112|81
bot/database_manager/delete_operator.py|4|6
bot/database_manager/drop_databases_dangerously.py|1|0
bot/database_manager/hydrate_common_db.py|1|1
bot/database_manager/location_context.py|9|4
bot/dbase.py|13|10
=== COMMIT MESSAGE ===
alembic migration: BREAKING CHANGES FOR LOCAL Schema updates for Neon,  (#361)

* works

* double quotes to single quotes

* blah

* passes error in as param

* i've broken generate_hourly_stats. need to fix

* fixed generate_ai_output for fb tool

* Upsell Intent Classification Minor Tweak (#385)

* minor prompt enhancements for upsell intent classification

* minor prompt enhancements for upsell intent classification

(cherry picked from commit 1f0147d12a5480e8a1f5ba01560934ebeb85a450)

* updates api/operations

* updates system_status

* Faq agent manager responses & Upsell ->  Modify prompt (#386)

* Re-phrase the Upsell -> Modify prompts, no functional change

* Changed the FAQ fallback language to exclude mention of 'manager'

(cherry picked from commit 91faf6d3dd36785957b1380b099079778bb915bc)

* Slight Upsell -> Modify tweak (#387)

* Re-phrase the Upsell -> Modify prompts, no functional change

* Changed the FAQ fallback language to exclude mention of 'manager'

* Slight Upsell to Modify Prompt Tweak

(cherry picked from commit 76eed7db1b435c78052f79f7aff9e82a6d07ebb0)

* updates location manager to PR-388

* fixes typo

(cherry picked from commit f0366dbaafced9bfa27d84c8ac020f94ac510420)

* updates neon migration

---------

Co-authored-by: Dreak618 <nkrein@u.rochester.edu>
Co-authored-by: md598 <Mark@duttonracing.com>
=== FILES CHANGED ===
README.md|2|7
bot/agent_task_review_tool.py|84|60
bot/alembic.ini|0|73
bot/audivi_system/order_eval.py|48|188
bot/database.py|63|50
bot/database_manager/address_manager.py|0|1
bot/database_manager/db_upgrade.sh|11|3
bot/database_manager/hydrate_common_db.py|6|5
bot/database_manager/hydrate_location.py|354|233
bot/database_manager/stats_updater.py|4|4
bot/database_manager/system_status.py|0|1
bot/database_manager/table_manager.py|2|2
bot/graveyard/alembic-old/alembic.ini|76|0
bot/{ => graveyard/alembic-old}/alembic_client.ini|0|0
bot/{alembic => graveyard/alembic-old}/client/env.py|2|1
bot/{alembic => graveyard/alembic-old}/client/script.py.mako|0|0
bot/graveyard/alembic-old/client/versions/20250701_1742_adc27acf50fa_initial_client_revision.py|173|0
bot/{alembic => graveyard/alembic-old}/common/env.py|4|2
bot/{alembic => graveyard/alembic-old}/common/script.py.mako|0|0
bot/graveyard/alembic-old/common/versions/20250701_1702_7636ea8d0023_initial_commit.py|211|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250115_0200_18d8e333f594_create_users_table.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250307_1842_224e5cbd67fd_create_tenant_tables.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250320_1340_10cb6b1cbf48_upgrades_to_locaiotn_pos_and_headset_.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250321_2250_43c0b0f9c686_added_hourly_performance_aggregation_.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250322_2234_f91fd1b3ec12_adding_monthly_rolling_table.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250323_0026_fb51d511dbb7_added_new_cols_to_orderevent_table.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250324_0347_1ad576ff8e0f_adding_operator_id_to_locaiton_table.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250325_1427_d2d911bc946a_added_brand_info_and_lane_num.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250326_2235_8f82d2b95693_hours_stats_rolling_table.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250327_1421_16f01ed4d58f_hypertables_and_locaiton_id.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250331_2325_d43ab94245d7_adding_brand_filename_to_locations.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250402_1835_162a335d4220_added_timezone_to_event_and_hourly_.py|0|0
bot/{alembic/client/versions => graveyard/alembic-old/old/old-versions-client}/20250421_1735_8f6926285dae_.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/20250115_0137_fb53307df34d_create_clients_table.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/20250227_1907_1ad370243987_add_ds_data_cols.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/20250307_1829_e9300ac08e95_update_clients_table.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/20250317_2229_a48a9eb2e582_updates_to_new_client_schema.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/20250320_1957_9a7bb8b61b4f_upgrades_pos_and_headset_tables.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/20250322_2108_043cbaf65345_update_operatorstautus_enum_handling.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/20250331_2207_7d552d3ffb6b_.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/20250421_1954_3511eb075395_.py|0|0
bot/graveyard/alembic-old/old/old-versions-common/20250626_2148_eb9b869b4ba2_update_schema_changes.py|67|0
bot/graveyard/alembic-old/old/old-versions-common/20250630_1733_0a7a40e33cb1_change_ds_data.py|25|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/20c4cb544ca1_add_ds_data.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/cef466eaa639_added_agent_memory_brand_name.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/da85106857e3_create_agent_memory_table.py|0|0
bot/{alembic/common/versions => graveyard/alembic-old/old/old-versions-common}/f57d4d930072_create_ds_data_autocorrect.py|0|0
bot/graveyard/alembic-old/old/old-versions/20250115_0137_fb53307df34d_create_clients_table.py|38|0
bot/graveyard/alembic-old/old/old-versions/20250227_1907_1ad370243987_add_ds_data_cols.py|81|0
bot/graveyard/alembic-old/old/old-versions/20250307_1829_e9300ac08e95_update_clients_table.py|37|0
bot/graveyard/alembic-old/old/old-versions/20250317_2229_a48a9eb2e582_updates_to_new_client_schema.py|54|0
bot/graveyard/alembic-old/old/old-versions/20250320_1957_9a7bb8b61b4f_upgrades_pos_and_headset_tables.py|353|0
bot/graveyard/alembic-old/old/old-versions/20250322_2108_043cbaf65345_update_operatorstautus_enum_handling.py|27|0
bot/graveyard/alembic-old/old/old-versions/20250331_2207_7d552d3ffb6b_.py|27|0
bot/graveyard/alembic-old/old/old-versions/20250421_1954_3511eb075395_.py|78|0
bot/graveyard/alembic-old/old/old-versions/20250626_2148_eb9b869b4ba2_update_schema_changes.py|67|0
bot/graveyard/alembic-old/old/old-versions/20250630_1733_0a7a40e33cb1_change_ds_data.py|25|0
bot/graveyard/alembic-old/old/old-versions/20c4cb544ca1_add_ds_data.py|77|0
bot/graveyard/alembic-old/old/old-versions/cef466eaa639_added_agent_memory_brand_name.py|35|0
bot/graveyard/alembic-old/old/old-versions/da85106857e3_create_agent_memory_table.py|58|0
bot/graveyard/alembic-old/old/old-versions/f57d4d930072_create_ds_data_autocorrect.py|42|0
bot/migrations/__init__.py|0|0
bot/migrations/alembic.ini|78|0
bot/migrations/schemas/client/20250701_1742_adc27acf50fa_initial_client_revision.py|173|0
bot/migrations/schemas/common/20250701_1702_7636ea8d0023_initial_commit.py|250|0
bot/migrations/schemas/env.py|87|0
bot/models/client.py|2|2
bot/models/common.py|17|21
bot/runner.py|4|4
bot/simulator/simulator_utils.py|4|3
scheduler/src/scheduler/jobs.py|3|2
=== COMMIT MESSAGE ===
Deepeval (#343)

* updates input text to triple meat whataburger meal

* adds aws bedrock inference profile script
=== FILES CHANGED ===
bedrock/make_inference_profile.py|64|0
bedrock/output.txt|101|0
deepeval/create_evaluation_dataset.py|1|1
deepeval/datasets/single-turn-deepeval-dataset.json|1|1
=== COMMIT MESSAGE ===
Improvements to scheduler (automation) (#334)

* first draft of scheduler refactor

* fixes

* improved async compatability

* fixes

* updates scheduler/Dockerfile to include uv image and mounts build caches

* Revert "updates scheduler/Dockerfile to include uv image and mounts build caches"

This reverts commit 8d7e09a7f5bc6c3c5946090d7d5dda746d90ce8c.

* updates scheduler/Dockerfile

---------

Co-authored-by: Brent Field <brent@audivi.ai>
Co-authored-by: Sean Reed <seanreed1111@gmail.com>
=== FILES CHANGED ===
docker-compose.yml|20|7
scheduler/Dockerfile|25|0
scheduler/requirements.txt|15|0
scheduler/src/scheduler/__init__.py|3|0
scheduler/src/scheduler/__main__.py|5|0
scheduler/src/scheduler/jobs.py|165|0
scheduler/src/scheduler/main.py|29|0
scheduler/src/scheduler/scheduler.py|379|0
=== COMMIT MESSAGE ===
Pipeline refactor 4 (#776)

* inti

* initial commit

* restore pipeline.py

* comments out pipeline_start_time error

* move all globals to the top

* formatted imports

* moves pipeline_2.py to pipeline.

* moves files to folder with all intermediate steps

* adds fix from PR777
=== FILES CHANGED ===
bot/pipeline.py|1213|1175
bot/pipeline_processors.py|1|0
bot/pipeline_transports.py|1|0
bot/pipeline_utils.py|1|0
bot/refactoring_steps/pipeline.py.bak|5434|0
bot/refactoring_steps/pipeline_1.py|5453|0
bot/refactoring_steps/pipeline_2.py|5477|0
=== COMMIT MESSAGE ===
Otel order confirmation merge branch (#800)

* disable transformers logging in env

* update

* adds back docker-compose-2.yml for local building

* more

* STT Log Spam reduction (#754)

* lang detect and STT logs only when there's words...

* lang detect and STT logs only when there's words...

* lang detect and STT logs only when there's words...

(cherry picked from commit 62fd96bab5223b3a076f7a9759656709baa4e948)

* update

* set enable_metric=False in pipelineParams

* adds more env to docker compose

* update

* puts flag in server to make tracing idempotent

* update otel collector

* update otel vars

* fixes mistral instrumentor

* really heavy-handed way to turn of transformers library otel tracing

* moves to torch cpu-only

* move files

* rewrite top of file

* rewrite top of file

* fix agent-api

* adds more otel to docker compose

* fix typos

* fix typos

* attempt 1

* fixed missing trace id on web demo

* attempt #3

* codex-attempt-1

* Revert "codex-attempt-1"

This reverts commit ea5d0c66f6731d532592cfe41c4d41e6439e0962.

* Revert "attempt #3"

This reverts commit ed9fe75d1b802fd23935517d0847baf0563a13cd.

* dummy traceid implementation

* moved entrypoint to uv

(cherry picked from commit 746b7cfe2f146c9ad6861268b46fffc5080ca1d9)

* fixes error with otel sampler

* changes bind mount

* update state machine to inject otel headers

* session independence from vehicle closure - multi-session architecture
state machine cleanup for garbage collection
pipeline hybrid restart approach

* includes trace id report

* fix microphone enable on subsequent vehicle

* Update .gitignore to include temporary files and directories for hme-client and state_machine_analysis

* fixes more agent-api calls

* adds more context headers

* revert some non otel changes

* comments out trace id override

* more

* adds back tracer for otel

* deletes posrelay from ecs build

---------

Co-authored-by: md598 <Mark@duttonracing.com>
Co-authored-by: Michael Moore <mike@audivi.ai>
=== FILES CHANGED ===
.github/workflows/dev-build-services.yml|0|16
.gitignore|7|1
agent_ensemble/app/main.py|48|0
agent_ensemble/app/utils/tracing_utils.py|11|66
agent_ensemble/app/utils/utils_common.py|17|3
agent_ensemble/pyproject.toml|139|0
agent_ensemble/requirements-stage1-infrastructure.txt|1|1
bot/Dockerfile|3|4
bot/Dockerfile.ecs_direct|1|1
bot/Dockerfile.hme_headset|4|1
bot/Dockerfile.v2|1|1
bot/api/operations.py|7|1
bot/audivi_system/src/context.py|1|0
bot/audivi_system/src/tracing_utils.py|38|39
bot/audivi_system/src/utils.py|19|0
bot/conversation_manager/state_machine.py|88|6
bot/headsets/providers/hme/server_v2.py|2|1
bot/pipeline/core.py|834|334
bot/pipeline_old.py|123|51
bot/pipeline_processors.py|0|1
bot/pipeline_transports.py|0|1
bot/pipeline_utils.py|0|1
bot/pyproject.toml|134|0
bot/refactoring_steps/pipeline.py.bak|126|127
bot/requirements-stage1-infrastructure.txt|16|0
bot/requirements.txt|3|2
bot/runner.py|10|12
diagrams/documents/TRANSFORMERS_OTEL_FIX_SUMMARY.md|127|0
diagrams/documents/TRANSFORMERS_OTEL_GUIDE.md|142|0
diagrams/documents/UNIFIED_TRACE_PROPAGATION.md|199|0
docker-compose-2.yml|8|6
docker-compose.yml|73|58
posrelay/.idea/posrelay.iml|10|0
pyproject.toml|28|0
reports/collector3-trace-groups2025-11-08.md|1104|0
reports/collector4-trace-groups.md|1002|0
scripts/group_trace_report.py|114|0
simple-web/.idea/workspace.xml|75|0
simple-web/package.json|4|1
simple-web/src/components/ui/switch.tsx|27|0
simple-web/src/index.tsx|39|2
simple-web/yarn.lock|746|6
uv.lock|6284|0
=== COMMIT MESSAGE ===
Otel hotfix - remove noisy otel (#819)

* remove format order otel

* removes num_alias_get_aliases

* removes write_event_from_location_context
=== FILES CHANGED ===
agent_ensemble/app/services/ensemble/ensemble_core.py|1|1
agent_ensemble/app/utils/utils_common.py|1|1
bot/audivi_system/src/utils.py|1|1
bot/telemetrix.py|1|1
=== COMMIT MESSAGE ===
Add service name to recordings (#845)

* updates path for files saved to s3

* consolidation
=== FILES CHANGED ===
bot/pipeline/core.py|3|1
=== COMMIT MESSAGE ===
moves file path (#847)


=== FILES CHANGED ===
bot/pipeline/core.py|2|4
=== COMMIT MESSAGE ===
adds env var to turn off all recording (#844)


=== FILES CHANGED ===
bot/pipeline/core.py|24|1
=== COMMIT MESSAGE ===
more

=== FILES CHANGED ===
bot/pipeline.py|1|1
=== COMMIT MESSAGE ===
default listen mode = True in pipeline.py

=== FILES CHANGED ===
bot/pipeline.py|2|2
=== COMMIT MESSAGE ===
defaults to listen mode on this branch. remove upon merge

=== FILES CHANGED ===
bot/headsets/providers/hme/server_v2.py|1|1